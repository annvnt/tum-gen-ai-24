"use strict";(()=>{var e={};e.id=704,e.ids=[704],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5227:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>w,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var r={};a.r(r),a.d(r,{POST:()=>c});var n=a(9303),o=a(8716),i=a(670),s=a(7070);let u=process.env.BACKEND_URL||"http://127.0.0.1:8000";async function c(e){try{let t=await e.formData(),a=await fetch(`${u}/api/financial/upload`,{method:"POST",body:t});if(!a.ok){let e=await a.text();throw Error(`Backend upload failed: ${e}`)}let r=await a.json(),n=await fetch(`${u}/api/financial/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_id:r.file_id})});if(!n.ok){let e=await n.text();throw Error(`Backend analysis failed: ${e}`)}let o=await n.json(),i={reportId:o.report_id,createdAt:new Date().toISOString(),summary:o.summary,tables:{balanceSheet:l(o.tables?.balance_sheet||[]),incomeStatement:l(o.tables?.income_statement||[]),cashFlowStatement:l(o.tables?.cash_flow_statement||[])}};return s.NextResponse.json({success:!0,report:i})}catch(e){return console.error("API Error:",e),s.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error occurred"},{status:500})}}function l(e){return Array.isArray(e)?e.map(e=>{if("object"==typeof e&&null!==e){let t=Object.keys(e),a=t.find(e=>e.toLowerCase().includes("indicator")||e.toLowerCase().includes("item")||e.toLowerCase().includes("name")||0===t.indexOf(e))||t[0],r=t.find(e=>e.includes("2024")||e.toLowerCase().includes("current")||e.toLowerCase().includes("this")||1===t.indexOf(e))||t[1],n=t.find(e=>e.includes("2023")||e.toLowerCase().includes("previous")||e.toLowerCase().includes("last")||2===t.indexOf(e))||t[2];return{indicator:e[a]||"Unknown",currentYear:e[r]||0,previousYear:e[n]||0}}return{indicator:"Unknown",currentYear:0,previousYear:0}}):[]}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/financial/upload/route",pathname:"/api/financial/upload",filename:"route",bundlePath:"app/api/financial/upload/route"},resolvedPagePath:"C:\\Users\\moham\\Desktop\\tum-gen-ai-24\\web\\app\\api\\financial\\upload\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:f,serverHooks:m}=d,w="/api/financial/upload/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972],()=>a(5227));module.exports=r})();